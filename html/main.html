{% load static %}
{% load i18n %}

<!DOCTYPE html>
<html>
<head>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-STD6S4PM77"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-STD6S4PM77');
    </script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Online community for people who love outdoor activities. Hiking, climbing, drytooling, iceclimbing. You will find everything you need. ">
    <meta name="keyword" content="">
    <title>{% block title %} {% endblock %}</title>

    <link href="{% static 'favicon.ico' %}"  rel="icon" type="image/x-icon" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/mg.css' %}" />
    <link rel="stylesheet" href="{% static 'css/main.css' %}" />
    <link rel="stylesheet" href="{% static 'css/tipped.css' %}" />
    <link href="//cdn.jsdelivr.net/npm/featherlight@1.7.14/release/featherlight.min.css" type="text/css" rel="stylesheet" />
    <link href="//cdn.jsdelivr.net/npm/featherlight@1.7.14/release/featherlight.gallery.min.css" type="text/css" rel="stylesheet" />
    <!-- charts ------>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.min.js"></script>              <!-- to be removed soon -->
    <script src="{% static "js/chart_plugin.js" %}"></script>                                                      <!-- to be removed soon -->
    <script src="https://cdn.bokeh.org/bokeh/release/bokeh-3.4.1.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.4.1.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.4.1.min.js" crossorigin="anonymous"></script>
    <!---------------->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2160021536917489" crossorigin="anonymous"></script>
    <!-------------->
    <<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <!----- AUTOCOMPLETE ----->
    <script src="{% static 'js/autocomplete.js' %}"></script>
    <!--- END AUTOCOMPLETE -->

    <script src="//cdn.jsdelivr.net/npm/featherlight@1.7.14/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="//cdn.jsdelivr.net/npm/featherlight@1.7.14/release/featherlight.gallery.min.js" type="text/javascript" charset="utf-8"></script>

    <!---- Go squered -->
    <script>
      !function(g,s,q,r,d){r=g[r]=g[r]||function(){(r.q=r.q||[]).push(arguments)};
      d=s.createElement(q);d.src='https://d1l6p2sc9645hc.cloudfront.net/gosquared.js';q=
      s.getElementsByTagName(q)[0];q.parentNode.insertBefore(d,q)}(window,document
      ,'script','_gs');
      _gs('GSN-293738-I');
      _gs('set', 'chat', { button: false });
      {% if user.is_authenticated %}
      _gs('identify', {
          email: '{{ user.email }}',
          name: '{{ user.username }}',          
      });
      {% endif %}
    </script>
    <!---- End Go squered -->
</head>
<body data-gr-c-s-loaded="true" class="d-flex flex-column h-100">
<div id="page">
    <header>
        <nav class="navbar navbar-expand-lg navbar-light fixed-top" style="background-color: #ecf0f1; height: 60px;">
            <button class="navbar-toggler m-2" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
            </button>
            <a href="/" class="navbar-brand">
               <div class="d-none d-sm-none d-md-none d-lg-block mt-4">
                   <img class="p-4" src="{% static 'img/MG.png' %}" style="width: 150px; height: auto; overflow: hidden;" />
               </div>
            </a>
            <div class="container-fluid">
                <div class="collapse navbar-collapse" id="navbarSupportedContent" style="background-color: #ecf0f1;">
                    <ul class="navbar-nav me-auto mb-1 mb-md-0">
                            {% if not user.is_authenticated %}
                              <li class="nav-item">
                                <a  class="btn btn-sm btn-outline-primary" href="/accounts/signup/">{% trans "Sign up" %}</a>
                              </li>
                            {% else %}
                               <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    {%  trans "Account" %}
                                </a>
                                <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                    <li><a class="dropdown-item" href="/start/profile/">{%  trans "Profile" %}</a></li>
                                    <li><a class="dropdown-item" href="/health/">{%  trans "Health" %}</a></li>
                                    <li><a class="dropdown-item" href="/settings/">{% trans "Settings" %}</a></li>
                                </ul>
                              </li>
                              <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                  {% trans "Your trips" %}
                                </a>
                                <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                    <li><a class="dropdown-item" href="/start/add/">{% trans "Add a trip" %}</a></li>
                                   <!-- <li><a class="dropdown-item disabled" href="">{% trans "Explore" %}</a></li>  -->
                                   <!-- <li><a class="dropdown-item disabled" href="#">{% trans "Past activities" %}</a></li> -->
                                </ul>
                              </li>
                              <li class="nav-item">
                                <a class="nav-link" href="/inbox/">
                                  {% trans "Messages" %}
                                </a>
                              </li>
                              <li class="nav-item">
                                <a class="nav-link" href="/groups/">
                                  {% trans "Groups" %}
                                </a>
                              </li>
                              <li class="nav-item">
                                <a class="nav-link" href="/shop/">
                                  {% trans "Shop" %}
                                </a>
                              </li>
                            {% endif %}
                        </ul>
                          {% if user.is_authenticated %}
                            <div class="d-flex">
                            <a href="#" class="me-5" onclick="showNotifications()" data-bs-toggle="modal" data-bs-target="#notificationsModal">
                                <span class="badge bg-secondary"  id="notifcount">0</span>
                            </a>
                            </div>
                            <form class="d-flex" method="get" action="/start/q/">
                                {% csrf_token %}
                                <input class="form-control me-3"  type="search" id="id_what" name="what" placeholder="{% trans 'Search' %}" autocomplete="off">
                                <button class="btn btn-sm btn-outline-success me-3" type="submit">{% trans "Search" %}</button>
                            </form>
                            {{ notif.count }}
                            <div class="autocomplete-suggestions"></div>
                            <a class="btn btn-outline-secondary btn-sm" href="/accounts/logout">{% trans "Logout" %}</a>

                          {% else %}
                            <a class="btn btn-outline-secondary btn-sm" href="/accounts/login">{%  trans "Log in" %}</a>
                          {% endif %}
                </div>
            </div>
        </nav>
    </header>
    <main class="flex-shrink-0" role="main">
{% block content %}


{% endblock %}
    </main>
    {% if user.is_authenticated %}
    <div class="modal fade" id="notificationsModal" tabindex="-1" aria-labelledby="notificationsModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
              <h5><a class="text-muted" href="/notifications">See all</a></h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div  class="d-flex flex-column align-items-center" id="notification_content">
                <div class="spinner-border" role="status"><span class="sr-only"></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    {% endif %}
    <footer class="footer fixed-bottom">
        <div class="container">
            <div class="row">
                <div class="col-md-12" style="text-align-last: left;">
                    <p class="d-inline text-wrap badge bg-dark">&copy;{% now "Y" %}</p>
                    <p class="d-inline text-wrap badge bg-light text-dark small text-decoration-none">
                    <a href="/about/" target="_blank">{% trans 'about' %}</a><b> | </b>
                    <a href="/privacy/" target="_blank">{% trans 'terms & privacy' %}</a><b> | </b>
                    <a href="https://kamilsj.github.io/mountaingrip/" target="_blank">{% trans 'code' %}</a><b> | </b>
                    <a href="https://www.buymeacoffee.com/mountaingrip/" target="_blank">{% trans 'donate' %}</a><b> | </b>
                    <a href="https://kurschinskiego.online" target="_blank">Learn Chinese</a>
                    </p>
                </div>
                <div class="mb-3"></div>
            </div>
        </div>
    </footer>

    <script src="{% static 'js/ajax.js' %}"></script>
    <script src="{% static 'js/mg.js' %}"></script>
    <script src="{% static 'js/tipped.js' %}"></script>


    <script type="text/javascript">
        <!-- public scripts -->
        $(function() {
          Tipped.create('.tp');
        });

        {% if user.is_authenticated %}
            <!-- authenticated scripts -->
            $(function(){
                //setInterval(function(){
                    update({{ user.id }}, 30000);
                //});
            });

            $('#id_what').autocomplete({
                serviceUrl: '/api/autocomplete/search/',
                dataType: 'json',
                onSelect: function (suggestion) {
                    
                }
            });
        {% endif %}
    </script>
</div>
</body>
</html>